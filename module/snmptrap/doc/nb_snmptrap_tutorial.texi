@c Snmptrap tutorial
@c   A section to the NodeBrain Tutorial and Snmptrap Nodebrain Module docs.

@quotation
@i{Man is the only kind of varmint who sets his own trap, baits it, then steps on it.}
---John Steinbeck (1902--1968)
@end quotation
The Snmptrap node is used to monitor SNMP traps.
This is one method of configuring NodeBrain to accept alerts from monitoring tools that are capable of sending SNMP traps.
NodeBrain's Snmptrap node is a bit unusual in that it does not use MIBs.  Instead, each trap is converted into a NodeBrain alert using single quoted OID terms.

@cartouche
@smallexample
alert '@i{oid}'="@i{value}",'@i{oid}'="@i{value}",...;
@end smallexample
@end cartouche

You must then code your rules referencing the @i{oid} terms.
However, I recommend you define aliases for the OIDs of interest to make your rules more readable.

@cartouche
@smallexample
#!/usr/local/bin/nb -d
# File: tutorial/Snmptrap/snmptrap.nb
-rm snmptrap.log
set log="snmptrap.log",out=".";
# Node
@b{define snmptrap node snmptrap:trace,dump;}
# Aliases
snmptrap. define myProduct cell '1.3.6.1.6.3.1.1.4.3'="1.3.6.1.4.1.1279";
snmptrap. define address cell '1.3.6.1.4.1.1279.4';
snmptrap. define type    cell '1.3.6.1.4.1.1279.5';
# Rules
snmptrap. define r1 if(myProduct and type="hiccup");
@end smallexample
@end cartouche

The example above is only provided to illustrate the syntax for working with single quoted OID terms.
You will need to adapt this example to the traps you want to monitor to construct useful rules.
However, you can use this example to start collecting traps right away.
The traps will show up in your @code{snmptrap.log} file.
Then, you can figure out what you want to monitor.

Remove the @code{:trace,dump} from your Snmptrap node specification to reduce the amount of information in your log.
@cartouche
@smallexample
@b{define snmptrap node snmptrap;}
@end smallexample
@end cartouche

You may use a @code{silent} option to stop logging the alerts generated by the Snmptrap node.
@cartouche
@smallexample
@b{define snmptrap node snmptrap:silent;}
@end smallexample
@end cartouche

